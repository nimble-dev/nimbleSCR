<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Cyril Milleret, Daniel Turek and Pierre Dupont" />

<meta name="date" content="2020-12-18" />

<title>Wolverine Example</title>

<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Wolverine Example</h1>
<h4 class="author">Cyril Milleret, Daniel Turek and Pierre Dupont</h4>
<h4 class="date">2020-12-18</h4>



<p>This vignette demonstrates the wolverine spatial capture-recapture model, as in “Efficient MCMC for Spatial Capture-Recapture Models” (Turek <em>et al</em>, <em>submitted</em>). Specifically, we implement the final version of the wolverine model and MCMC using nimble <span class="citation">(de Valpine et al. 2017; NIMBLE Development Team 2020)</span>. Details of the functions and procedure are provided therein.</p>
<div id="load-libraries" class="section level3">
<h3>Load Libraries</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(nimble)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(basicMCMCplots)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(coda)</a></code></pre></div>
</div>
<div id="load-nimblescr-package" class="section level3">
<h3>Load nimbleSCR package</h3>
<p>We compiled all functions in the nimbleSCR package version 0.1.0 <span class="citation">(Bischof et al. 2020)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(nimbleSCR)</a></code></pre></div>
</div>
<div id="define-model-structure" class="section level3">
<h3>Define Model Structure</h3>
<p>Here, we define the <code>nimble</code> model structure.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">code &lt;-<span class="st"> </span><span class="kw">nimbleCode</span>({</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="co">## priors</span></a>
<a class="sourceLine" id="cb3-3" title="3">  psi <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">  sigma <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-5" title="5">  p0 <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="co">## loop over individuals</span></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n.individuals) {</a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="co">## AC coordinates</span></a>
<a class="sourceLine" id="cb3-9" title="9">    sxy[i,<span class="dv">1</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, x.max)</a>
<a class="sourceLine" id="cb3-10" title="10">    sxy[i,<span class="dv">2</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, y.max)</a>
<a class="sourceLine" id="cb3-11" title="11">    <span class="co">## habitat constraint </span></a>
<a class="sourceLine" id="cb3-12" title="12">    ones[i] <span class="op">~</span><span class="st"> </span><span class="kw">dHabitatMask</span>( <span class="dt">s =</span> sxy[i,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb3-13" title="13">                            <span class="dt">xmin =</span> lowerCoords[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb3-14" title="14">                            <span class="dt">xmax =</span> upperCoords[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb3-15" title="15">                            <span class="dt">ymin =</span> lowerCoords[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb3-16" title="16">                            <span class="dt">ymax =</span> upperCoords[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb3-17" title="17">                            <span class="dt">habitat =</span> habitat.mx[<span class="dv">1</span><span class="op">:</span>y.max,<span class="dv">1</span><span class="op">:</span>x.max])</a>
<a class="sourceLine" id="cb3-18" title="18">    <span class="co">## latent dead/alive indicators</span></a>
<a class="sourceLine" id="cb3-19" title="19">    z[i] <span class="op">~</span><span class="st"> </span><span class="kw">dbern</span>(psi)</a>
<a class="sourceLine" id="cb3-20" title="20">    <span class="co">## likelihood</span></a>
<a class="sourceLine" id="cb3-21" title="21">    y[i, <span class="dv">1</span><span class="op">:</span>nMaxDetectors] <span class="op">~</span><span class="st"> </span><span class="kw">dbinomLocal_normal</span>( <span class="dt">detNums =</span> nbDetections[i],</a>
<a class="sourceLine" id="cb3-22" title="22">                                                   <span class="dt">detIndices =</span> yDets[i,<span class="dv">1</span><span class="op">:</span>nMaxDetectors],</a>
<a class="sourceLine" id="cb3-23" title="23">                                                   <span class="dt">size =</span> trials[<span class="dv">1</span><span class="op">:</span>n.detectors],</a>
<a class="sourceLine" id="cb3-24" title="24">                                                   <span class="dt">p0 =</span> p0,</a>
<a class="sourceLine" id="cb3-25" title="25">                                                   <span class="dt">s =</span> sxy[i,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb3-26" title="26">                                                   <span class="dt">sigma =</span> sigma,</a>
<a class="sourceLine" id="cb3-27" title="27">                                                   <span class="dt">trapCoords =</span> detector.xy[<span class="dv">1</span><span class="op">:</span>n.detectors,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb3-28" title="28">                                                   <span class="dt">localTrapsIndices =</span> detectorIndex[<span class="dv">1</span><span class="op">:</span>n.cells,<span class="dv">1</span><span class="op">:</span>maxNBDets],</a>
<a class="sourceLine" id="cb3-29" title="29">                                                   <span class="dt">localTrapsNum =</span> nDetectors[<span class="dv">1</span><span class="op">:</span>n.cells],</a>
<a class="sourceLine" id="cb3-30" title="30">                                                   <span class="dt">resizeFactor =</span> ResizeFactor,</a>
<a class="sourceLine" id="cb3-31" title="31">                                                   <span class="dt">habitatGrid =</span> habitatIDDet[<span class="dv">1</span><span class="op">:</span>y.maxDet,<span class="dv">1</span><span class="op">:</span>x.maxDet],</a>
<a class="sourceLine" id="cb3-32" title="32">                                                   <span class="dt">indicator =</span> z[i])</a>
<a class="sourceLine" id="cb3-33" title="33">  }</a>
<a class="sourceLine" id="cb3-34" title="34">  <span class="co">## derived quantity: total population size</span></a>
<a class="sourceLine" id="cb3-35" title="35">  N &lt;-<span class="st"> </span><span class="kw">sum</span>(z[<span class="dv">1</span><span class="op">:</span>n.individuals])</a>
<a class="sourceLine" id="cb3-36" title="36">})</a></code></pre></div>
</div>
<div id="load-and-process-data" class="section level3">
<h3>Load and Process Data</h3>
<p>We load the wolverine example data available from the Dryad Digital Repository <span class="citation">(Milleret et al. 2018)</span>. See <span class="citation">Milleret et al. (2019)</span> for a complete description of the data.</p>
<p>The data file can be downloaded at [<a href="https://doi.org/10.5061/dryad.42m96c8" class="uri">https://doi.org/10.5061/dryad.42m96c8</a>].</p>
<p>We also create objects <code>code</code>, <code>constants</code>, <code>data</code>, and <code>inits</code> for later use in the function <code>nimbleModel</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">load</span>(<span class="st">&quot;WolverineData.RData&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">data &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">y =</span> my.jags.input<span class="op">$</span>y,</a>
<a class="sourceLine" id="cb5-2" title="2">             <span class="dt">z =</span> my.jags.input<span class="op">$</span>z,</a>
<a class="sourceLine" id="cb5-3" title="3">             <span class="dt">detector.xy =</span> my.jags.input<span class="op">$</span>detector.xy,</a>
<a class="sourceLine" id="cb5-4" title="4">             <span class="dt">habitat.mx =</span> my.jags.input<span class="op">$</span>habitat.mx,</a>
<a class="sourceLine" id="cb5-5" title="5">             <span class="dt">ones =</span> my.jags.input<span class="op">$</span>OK,</a>
<a class="sourceLine" id="cb5-6" title="6">             <span class="dt">lowerCoords =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb5-7" title="7">             <span class="dt">upperCoords =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb5-8" title="8">               <span class="kw">dim</span>(my.jags.input<span class="op">$</span>habitat.mx)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb5-9" title="9">               <span class="kw">dim</span>(my.jags.input<span class="op">$</span>habitat.mx)[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb5-10" title="10">             <span class="dt">trials =</span> <span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">dim</span>(my.jags.input<span class="op">$</span>detector.xy)[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb5-11" title="11">constants &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">n.individuals =</span> my.jags.input<span class="op">$</span>n.individuals,</a>
<a class="sourceLine" id="cb5-12" title="12">                  <span class="dt">n.detectors =</span> <span class="kw">dim</span>(my.jags.input<span class="op">$</span>detector.xy)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb5-13" title="13">                  <span class="dt">y.max =</span> <span class="kw">dim</span>(my.jags.input<span class="op">$</span>habitat.mx)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb5-14" title="14">                  <span class="dt">x.max =</span> <span class="kw">dim</span>(my.jags.input<span class="op">$</span>habitat.mx)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb5-15" title="15">inits &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">sxy =</span> inits<span class="fl">.1</span><span class="op">$</span>sxy,</a>
<a class="sourceLine" id="cb5-16" title="16">              <span class="dt">z =</span> inits<span class="fl">.1</span><span class="op">$</span>z,</a>
<a class="sourceLine" id="cb5-17" title="17">              <span class="dt">p0 =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb5-18" title="18">              <span class="dt">psi =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb5-19" title="19">              <span class="dt">sigma =</span> <span class="dv">6</span>)</a></code></pre></div>
</div>
<div id="use-of-custom-distribution-to-increase-mcmc-efficiency" class="section level2">
<h2>Use of custom distribution to increase MCMC efficiency</h2>
<p>The <code>dbinomLocal_normal()</code> distribution incorporates three features to increase computational efficiency.</p>
<div id="local-detector-evaluation" class="section level3">
<h3>1. Local detector evaluation</h3>
<p>This step restricts calculations of the detection probabilities (here using a halfnormal function) to detectors (traps) within a radius where detections are realistically possible <span class="citation">(Milleret et al. 2019)</span>. We use the function <code>getLocalObjects</code> to identify the set of detectors that are within a certain distance <span class="math inline">\(d_{max}\)</span> of each habitat cell center (<span style="color: blue;">blue points</span> in the plot below). These reduced sets of detectors are stored in the <code>localIndices</code> matrix and are later used in the local evaluation of the detection model to speed up calculations. The value of <span class="math inline">\(d_{max}\)</span> should be as small as possible in order to reduce computation but always large enough so that for any particular individual, the set of local traps associated with the coordinates of the activity center <code>s</code> include all detectors at which that individual was detected. The <span class="math inline">\(d_{max}\)</span> value will therefore affect the number of columns in <code>localIndices</code> Here, we use <span class="math inline">\(d_{max}=38\)</span>. with the coordinates of the activity center s … We also aggregated the habitat matrix to obtain larger habitat cells (lower resolution) and obtain objects with smaller dimensions. This reduces the number of habitat cells for which we have to identify the set of detectors that are within <span class="math inline">\(d_{max}\)</span> of the cell center. The goal is to create the object <code>localIndices</code> of the smallest dimension possible, that balances the cost of looking up relevant grid cells and reducing calculations for each grid cell.</p>
<p>Here, we resize the habitat matrix by a factor of 24, which corresponds to the <code>resizeFactor</code> argument. This means that 24x24 cells are aggregated into a single cell. The <code>resizeFactor</code> value will affect how many rows <code>localIndices</code> will be composed of.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">DetectorIndex &lt;-<span class="st"> </span><span class="kw">getLocalObjects</span>(<span class="dt">habitatMask =</span> data<span class="op">$</span>habitat.mx,</a>
<a class="sourceLine" id="cb6-2" title="2">                               <span class="dt">coords =</span> data<span class="op">$</span>detector.xy,</a>
<a class="sourceLine" id="cb6-3" title="3">                               <span class="dt">dmax =</span> <span class="dv">38</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">                               <span class="dt">resizeFactor =</span> <span class="dv">24</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">constants<span class="op">$</span>y.maxDet &lt;-<span class="st"> </span><span class="kw">dim</span>(DetectorIndex<span class="op">$</span>habitatGrid)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-2" title="2">constants<span class="op">$</span>x.maxDet &lt;-<span class="st"> </span><span class="kw">dim</span>(DetectorIndex<span class="op">$</span>habitatGrid)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb7-3" title="3">constants<span class="op">$</span>ResizeFactor &lt;-<span class="st"> </span>DetectorIndex<span class="op">$</span>resizeFactor</a>
<a class="sourceLine" id="cb7-4" title="4">constants<span class="op">$</span>n.cells &lt;-<span class="st"> </span><span class="kw">dim</span>(DetectorIndex<span class="op">$</span>localIndices)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-5" title="5">constants<span class="op">$</span>maxNBDets &lt;-<span class="st"> </span>DetectorIndex<span class="op">$</span>numLocalIndicesMax</a>
<a class="sourceLine" id="cb7-6" title="6">data<span class="op">$</span>detectorIndex &lt;-<span class="st"> </span>DetectorIndex<span class="op">$</span>localIndices</a>
<a class="sourceLine" id="cb7-7" title="7">data<span class="op">$</span>nDetectors &lt;-<span class="st"> </span>DetectorIndex<span class="op">$</span>numLocalIndices</a>
<a class="sourceLine" id="cb7-8" title="8">data<span class="op">$</span>habitatIDDet &lt;-<span class="st"> </span>DetectorIndex<span class="op">$</span>habitatGrid</a></code></pre></div>
</div>
<div id="sparse-representation-of-the-observation-matrix" class="section level3">
<h3>2. Sparse representation of the observation matrix</h3>
<p>We re-express <code>y</code> as a sparse representation of the detection matrix to reduce its size. In this representation, we turn the detection matrix <code>y</code> into three objects:</p>
<ul>
<li><code>detIndices</code>: where each row (corresponding to one individual) contains the identification numbers of detectors at which that individual was detected.</li>
<li><code>y</code>: a second matrix of identical dimension, containing the number of detections of a given individual at each detector. This second matrix is necessary for modelling non-binary detections (e.g. <span class="math inline">\(binomial\)</span> observation models)</li>
<li><code>detNums</code>: a vector containing the number of detectors at which each individual was detected.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">ySparse &lt;-<span class="st"> </span><span class="kw">getSparseY</span>(<span class="dt">x =</span> my.jags.input<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb8-2" title="2">data<span class="op">$</span>y &lt;-<span class="st"> </span>ySparse<span class="op">$</span>y[,,<span class="dv">1</span>]  </a>
<a class="sourceLine" id="cb8-3" title="3">data<span class="op">$</span>yDets &lt;-<span class="st"> </span>ySparse<span class="op">$</span>detIndices[,,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-4" title="4">data<span class="op">$</span>nbDetections &lt;-<span class="st"> </span>ySparse<span class="op">$</span>detNums[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-5" title="5">constants<span class="op">$</span>nMaxDetectors &lt;-<span class="st"> </span>ySparse<span class="op">$</span>maxDetNums</a></code></pre></div>
</div>
<div id="skip-unnecessary-calculations" class="section level3">
<h3>3. Skip unnecessary calculations</h3>
<p>The function <code>dbinomLocal_normal()</code> takes the <code>logical</code> argument <code>indicator</code> that specifies whether the individual <code>i</code> is available (<span class="math inline">\(z_i\)</span> = 1) for detection or not (<span class="math inline">\(z_i\)</span> = 0). When <span class="math inline">\(z_i\)</span> = 0, calculations of <span class="math inline">\(p_{ij}\)</span> are not performed and therefore increases MCMC efficiency.</p>
</div>
</div>
<div id="create-nimble-model" class="section level2">
<h2>Create NIMBLE Model</h2>
<p>Now, we can create the <code>nimble</code> model object, using the model structure defined in <code>code</code>, and the constants, data, and initial values.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">Rmodel &lt;-<span class="st"> </span><span class="kw">nimbleModel</span>(code, constants, data, inits)</a></code></pre></div>
<pre><code>## defining model...</code></pre>
<pre><code>## building model...</code></pre>
<pre><code>## setting data and initial values...</code></pre>
<pre><code>## running calculate on model (any error reports that follow may simply reflect missing values in model variables) ... 
## checking model sizes and dimensions...
## model building finished.</code></pre>
<div id="configure-and-build-mcmc" class="section level4">
<h4>Configure and Build MCMC</h4>
<p>We configure an MCMC algorithm to the <code>Rmodel</code> model object.</p>
<p>We assign MCMC monitors to <span class="math inline">\(N\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(p_0\)</span>.</p>
</div>
<div id="block-sampling-to-increase-mcmc-efficiency" class="section level4">
<h4>Block sampling to increase MCMC efficiency</h4>
<p>We also remove the univariate Metropolis-Hastings samplers that were assigned by default to each dimension of the <code>sxy</code> variables (ACs). Instead, we add joint Metropolis-Hastings samplers (<code>RW_block</code>) samplers to each <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> coordinate pair <code>sxy[i, 1:2]</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">conf &lt;-<span class="st"> </span><span class="kw">configureMCMC</span>(Rmodel, <span class="dt">monitors =</span> <span class="kw">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;p0&quot;</span>), <span class="dt">print =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">conf<span class="op">$</span><span class="kw">removeSamplers</span>(<span class="st">&quot;sxy&quot;</span>)</a>
<a class="sourceLine" id="cb14-3" title="3">ACnodes &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;sxy[&quot;</span>, <span class="dv">1</span><span class="op">:</span>constants<span class="op">$</span>n.individuals, <span class="st">&quot;, 1:2]&quot;</span>)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="cf">for</span>(node <span class="cf">in</span> ACnodes) {</a>
<a class="sourceLine" id="cb14-5" title="5">  conf<span class="op">$</span><span class="kw">addSampler</span>(<span class="dt">target =</span> node,</a>
<a class="sourceLine" id="cb14-6" title="6">                  <span class="dt">type =</span> <span class="st">&quot;RW_block&quot;</span>,</a>
<a class="sourceLine" id="cb14-7" title="7">                  <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adaptScaleOnly =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb14-8" title="8">                  <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-9" title="9">}</a>
<a class="sourceLine" id="cb14-10" title="10">Rmcmc &lt;-<span class="st"> </span><span class="kw">buildMCMC</span>(conf)</a></code></pre></div>
</div>
<div id="compile-and-run-mcmc" class="section level4">
<h4>Compile and Run MCMC</h4>
<p>Finally, we compile both the model and MCMC objects and execute the compiled MCMC for 10 000 iterations.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">Cmodel &lt;-<span class="st"> </span><span class="kw">compileNimble</span>(Rmodel)</a></code></pre></div>
<pre><code>## compiling... this may take a minute. Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.</code></pre>
<pre><code>## compilation finished.</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">Cmcmc &lt;-<span class="st"> </span><span class="kw">compileNimble</span>(Rmcmc, <span class="dt">project =</span> Rmodel)</a></code></pre></div>
<pre><code>## compiling... this may take a minute. Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.
## compilation finished.</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">MCMC_runtime &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb20-2" title="2">  samples &lt;-<span class="st"> </span><span class="kw">runMCMC</span>(Cmcmc, <span class="dt">niter =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb20-3" title="3">)</a></code></pre></div>
<pre><code>## running chain 1...</code></pre>
<pre><code>## |-------------|-------------|-------------|-------------|
## |-------------------------------------------------------|</code></pre>
</div>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<p>First, we can extract the MCMC runtime (7.6 minutes in this case):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">round</span>(MCMC_runtime[<span class="dv">3</span>] <span class="op">/</span><span class="st"> </span><span class="dv">60</span>, <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## elapsed 
##     7.6</code></pre>
<p>Next, we can check the posterior effective sample size (ESS) resulting from our 10 000 posterior samples for the three parameters we tracked (<span class="math inline">\(N\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(p_0\)</span>):</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">round</span>(<span class="kw">effectiveSize</span>(samples),<span class="dv">2</span>) </a></code></pre></div>
<pre><code>##      N     p0  sigma 
## 429.54 329.80 197.00</code></pre>
<p>We can also calculate the MCMC efficiency for each parameter; this corresponds to the rate of generating effectively independent posterior samples, per second of MCMC runtime:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"> <span class="kw">round</span>(<span class="kw">effectiveSize</span>(samples)<span class="op">/</span>MCMC_runtime[<span class="dv">3</span>],<span class="dv">2</span>)  </a></code></pre></div>
<pre><code>##     N    p0 sigma 
##  0.94  0.72  0.43</code></pre>
<p>Summary of posterior distributions for each parameter:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">round</span>(<span class="kw">samplesSummary</span>(samples), <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##         Mean Median St.Dev. 95%CI_low 95%CI_upp
## N     391.24 390.00   25.27    346.00    444.00
## p0      0.05   0.05    0.01      0.04      0.06
## sigma   5.85   5.84    0.26      5.40      6.40</code></pre>
<p>Examine traceplots and posterior distributions:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">basicMCMCplots<span class="op">::</span><span class="kw">chainsPlot</span>(samples)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA51BMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmOjpmOmZmOpBmZgBmZjpmZmZmZpBmZrZmkGZmkLZmkNtmtrZmtttmtv+QOjqQOmaQZjqQZmaQZpCQkGaQkJCQtraQttuQtv+Q2/+2ZgC2Zjq2Zma2kGa2kJC2kLa2tma2tpC2ttu227a22/+2/9u2///bkDrbkGbbkJDbtmbbtpDb25Db27bb29vb2//b/9vb////AAD/o6P/tmb/tpD/zMz/25D/27b/29v//7b//9v///8v7pXtAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPmklEQVR4nO2dC2MTNxLHHQ5ymBIg3MVwcPhKQss5D66U4Lik4c6Km6RY3//znPellbQjjaSdfRn9WxJ7pF2Nfpl9alcz4lFWjbp2oO+KgBBFQIgiIEQREKIICBERoNvdB3y1M6NZWW1RekMGaGfWJ0B03pABGj3tEyA6b8gAPbz3S48A0XlDBuifzx72CBCdN2SAphejHgGi84YOULJnpFlZbVF6QweIH/cJEJk38UQRUQSEKAJCFAEhMgEatSRHL7vzxgjIzfO6cgXUrBe2ZogBMc/6jQC6vr6+8fTD3EwdQAANB0BKFXJA14lubsIIdQWImb9RA0rgZHJdAmsmBBDTfgNFFmOTgEo+QYQaAKQD6RpQySdkI+sMEKtWYXgzjt7IkgCFhBAG6Hb/h8nD14a6Ui97C0jh0wCgD8vNj8UcqMtwQGW/K5A6AuRPCAN09p7zu6NwQEwDJOq1BEjjQw9ofTmZvPqvZmf5DzMgJn1hJTSW/pd+YpK5PUD+u2kM0Ol8NT54otmdAbGsFiuWaB2QHkD+IYQC+ny01PdBWdc0QCJGckCMSYAYCkjaDocF6OTV4Xz94zy7eM5tBSBmAsQAQIyzYpn0//xDGVtNAKry8d7G0POgPz+eX85UOyt6WARGbsu/CEAMAcSaBnRdBeQdQuhO+uvXq5faTloGVGxoRWcLDhZAzACo2FURAgL4UANajH/++OjXZWEv97oyoBxG+YWXYcLLqjCgHG8ZkmSAwAAi38TuJp9elvYyMqqAGAqIVQGxJgFBfHwJ4ddi67O90g4AknuvmDUYRkBs4IAUu/irw4CkjsKAdHG9yKnnVi+F4C3Ml1AgoLKDYL/lSt0BMvDpByBHdQHI71RoewEZA8gvhDoGVCXWAiCvEAoABMVA/wAZd9GeIVQbELHwnmNe5rLx8Qmh7xKQTwg5A8qu5gcDyM7HI4S2NYLsgDxC6HsF5ExoSwGhfCIgKkLbCch6EhQBOQWQK6HvF5DjoR4DpI3NbxEgxxDCAOlj84MA5MbHLYQwQPrYvHeH+wvILYTQYR9tbN6r87zfgJxCCAOkj81DN1NxQCVY9QasdhebCJBrADmFEApIG5vXAamQqvfp8/+5vgx07611QC4hhAHSx+blER4IkDzgIwZabYC4VJMGkMtZonsIoedB2tg8AoibAXEcEKcB5M7HIYTw86An/zrYUwFxDZAYgFcAcdFtrgDKbYIINSCfAHIIIfw8aDFT9kFcBsSrgAoW0mNEJaDiu3hWJg8lLj9wVBeQDx+cELqT3mxe68MqIPEwBhO9LT5wAUcDVD4/JZ4rkgFxEkCefNCNDD0P+s+Sa88HMdEZORrKD50C8tvAEkIIIs+LVUlmQNIXpjxlJyMEFsoL6gDy5oMGUTgg9bGwQECcGpA/HySIagOSv0ufKyw0EgbVAxQSPxiiWoDM6gRQMB8booYAVWu51bY1b6+WvTRXQ9lrd07eNALIXe6AagFxkcEbR0BNiWRcjExegLp7Ebtf3rT0t6kv31A32L23mAjIbo+AEPtwAHWlCAhRBIQoAkIUASEaAKD14ePz9dk4/VexH05e/U+zc34xheonZqB6YatUzzQAQIvZt7+dTddHyb+lZv/99ea3Zue3+9MFUH9jvgWqFza9eq4BAOLrs9cnM356sPk31+yr8f6bE82+PvoyBeonZqh6YausPtMQAPGrF4dzfjqZ6z24enG1rNoXs9X0tFo/Md8B1QtbdfWpBgDocs5PJrP14btZMeRS2l+cZ2VypJxN9h+dVeqn5g/V6vy3c3j1uQYA6Pb52yd3z9++Tv7p9ttxVqYusQkVoP7GDFUvbNXVpBoAoG4VASGKgBBFQIgiIEQREKIICFEEhCgCQhQBIYqAEFECuhjtvCFcXU0ReUMI6PavPcp/ROYNBaDb3cnu6Cm/uDdPElp0LWJvaAA9WH4ZTY8Tl54SrK9X3tAAmvJvz572BhCpN4SAerOJkXpDA+h+EtQbf/qwkyb2hmonvZMMnuz24TBP7A3VJtYfEXsTASGKlxqIIiBEERCi+Bgw4k18kBxpxh+Q//sGliVpAQUmhbI2UxuQ/pqcRREQohYA1SPkDKiyv2KGz7xXgK5v2gJUsQcCAt7BdGw+qFrXgJj0WSrqF6BahAgAsUBAYt4Bx+aDqiWAau2n6QGx3gG6Kd61bDcBWwGICUDipzwHgybWLiDl7cqgAxoGyJyADQBUTDQgAWLSL1FHrEADxIwuOXpekXjPdxM810E7bAyQNQGbBEhMwlACyuzlBBXZUhAgNeAaAXSTvxTttm6kGdkmJnmDz4OKKXJKLuoHGZCw5strYAXGZgCVW5qfMEBQArY8QPJuKZMsgYDKeWKYDoi1DYg8fdbqyR+VBGyugJgLoAJTOTfMsAB9WJ7O+WKm2AUgacotR0DMBohoDjNZzQNavF+8vzoCM9S5Aion5hKAyp1VAYi1BYg8O9TlZPziXLVL/alM9Fb0FgMkLSitiRpQCwnYoPMgGZDUQz9AlcUHCkicB0mHeRVJVRIg5gBI4eTYc8dqBBnYnM+DuBZBzoCYDoi1BogiRV3geZAVUE5E67wCCMZKDgji43nF6nKxuv6wlO0sDJBUZFncrecmz1WZZlxyW7+lGeRq3g2Q5WtrgGA+tICAo5gLIB96TQEyT9nl1oC5GeRqvjYgKzwyQJYpzdwaMDeDXM0PBZCRDykg4CjWGBxSQB0lYEs0EEAWPg0mYEs0fECNJGAr7Q3ugegA2WedbC4BW6JhALIGkAeh7xRQY/nFEg0BEDqvq3MIOQPKzoOyTlS71TtAWAA5EwqIIF69Du0bIKeJgcObCQfkBQq+6UEByHHi5OBmhg/IiQ9N+izQXmGC3QxTkIBLUgJynXmbJDsUaNe6qd5OtezC1VGMpgB5zEwe2Aw2qiExycctimM/129G64Ckm9PNAXLmQ5H8CBrV4PnQRNFl8RwHCkgeEZMASedW9QH5TG1PkPwIGtWoAOLAkz5VQFwHVA6dkQLyCCCC5EfQqIYjoGKYIiPCNUD5GkqzsNYD5JcbAQ8hFNDXr1cvDYC4GyDp+RYjIE4FyDd3BJbaBwW0GP/88dGvS9XOmPqbQ4A4CKj4WmCVABXl9QD58cERoYf5u8mnl7odAMQhQKIGU8phQJwCUFhuHxsh/Dxofban2wUYV0BqeWlkymL1AQUmZ6mT/Mh0HqR0qfKZs4oFIKGrNqDw5DVezbieB/G+AaqT3MejGYfzIFMPua0Cukw4oOtc4XzMe+qg8yCHzlblvIwnoNppoQpEcHool4tV7ekO3htABFzsMniDXs03K5pxMSp5HcW6exEb8rI7b8CjWM9lpOpd4PD3MR3F+qzOAMlHsT6rM0BRgCIgRBEQoggIUQSEaFCAsgRO2c+LKViQ5Hpagkucjf8N2ReTyQsoK1ShQQHKEjulP2/3p2DB768NS5xN1z8toTXx25fcokEByhI7JT8/H32ZggW/jPffgAWTd+MZZJ+DGX1KDQrQ6bz4/91sNQULPi2VHE9lwd+n6x/ngH2+gjL6lBoUoEWawGnz8+0/JvuPlkDB4U/nSVwABWr6sNI+P7HPZzooQEkCp1WexkmJoLIgyfUEFzw/3IPsclxBGhSgLhQBIYqAEEVAiCIgRBEQoggIUQSEKAJCFAEhioAQ1Qa01TP+8xhBqGoAWuyO/jJL/2aL3Z2DJBfKZHf0+O0oyfpxMho9BpK3N6imvAkHlKQWOr6/TFLEjN6sjxOXHiwvRk/5yb356v6y5Sw2jXkTDujbs9HO4/Pkb3Zxb85XaTad5Be/2DhzebA7anXf1Jg3NTax9eX+aGemubRxZ+PSxc6bL+0CasybepvYInVJBLVw6fje/KJdQI15UyOCvuwme8DEkYvRzkRx6XZ39EPLudia8obiMJ9s6oseZBbLROwNyXnQ5jC6Yx88aVO03sQTRUQRECLjw2ndPVfaL2/ic9JIMxEQ0owFUMg7CL6iA4S+bxnYzHYAyl5yacQbsOlsfzUkQOJ9FHJvtiKCrm8iIKsiIEdAdQltK6Drm5YAaW89DxBQzUO9z/tiwwRUkxAGSHvrmbVAiBpQsxnqtLeehwmo6Qx10lvPQwGkvShO7I3tTDoC0mzHe0vZLs3m0piGBej00754U2a4gGoQQgHN+dXhWD+K9R1Q/cR01mZk229LxR4B2ZqOgJCmfQEZ5w/yd8mzWgRkr1Y/cZ+9GQJAPjNQ6dOcNQEonFDYiSIEyH2KLraVgDgWQQCgqolX7ZWCgQMSscHUWQCr0wQytRQDxIq1bwEghgMS09zmRWIiUi6Dkyea3FpAMoJMTAHEnAARzidNkfrR3oztlmsZFxIgMXOrTEueLVpMcJstKM11O3hA+i1XBRADAekTbhdVmYglCQrXpra39hz1PFOrgPRbrtL069Lc6zogRQAgeUJqvXJtQBTJQ+3N2G65gjONy18qfGRAcnlzgCA+wXfufW+5BgBSl+kIUHAI+Z5JGwFBNCATVz/RAzLwCQ0hDNDqyR/jgyeSvdp/Cw1rebuAQkMIP4qdJhN+SPaagLDFmwMURggDtHi/eH+lTJccAam2y8m4mK6qBFSTQpOAiNKrWpuxXGpwH0AhGC3Nu3nZA0DcD5AfJkvzbl4S5Z+1NmMHxF0AceXssEVA1snJ3VaMN1MXEAcBcbmCcQWW5p287Acg5FCmACo/SKUKNXGl3zigEEKeZ9KplPsTrBpPOSCOAcpPzCkBIdP/u60ZbcYhgpRLKnFbTNwBEYCKn5mh2L44VwFJa7Q07+Illh/BbdVYMxigVKy4mWgBxMubZGIp5RPjZXqorQPEdUC8iBoNkLKUDkgrtTXv4CWeYcNt3UgzlluusNwBSUxYpaj+uBjKx/+a3vOWKyylr0z5bgbk5ZJbNYcULd6EPG+5GgRuKqGqAQjl47+Red5ydVMtPuGAHBP0+r1F5nnL1U2dACJOH2rzBjtRRNU6IO/kWVkYFcEE54UyeyPbTucr9Zari9oC5IMkSAZvFECfk2nMsZ00qWoPHJIKA3Ty6nBeTK/c4ZvqkJfdeaPY/vx4ftmXOUpAVXqAGvwreJb3SxFQ/xQBIYqAEEVAiCIgRBEQosEAytI+ZVmdDErzP1lqZImgrKuoajCAbtNbnVk+J1iLNP+TrUaaCMpaoarBAFqlaZ9OlAw9qk7T/E+2GmkiKFsFQIMBdLcsUzrBOk7zP9lqpImgbBUADQbQb2napyyrE6wsNJAa3FoB0GAAJWmfisxQhhrPD/esNZIAs68C0GAAdaUICFEEhCgCQhQBIYqAEEVAiCIgRBEQoggIUQSE6P8HoU4Ki18HOAAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-nimbleSCR">
<p>Bischof, Richard, Daniel Turek, Cyril Milleret, Torbjørn Ergon, Pierre Dupont, and de Valpine Perry. 2020. <em>NimbleSCR: Spatial Capture-Recapture (Scr) Methods Using ’Nimble’</em>.</p>
</div>
<div id="ref-de2017programming">
<p>de Valpine, Perry, Daniel Turek, Christopher J Paciorek, Clifford Anderson-Bergman, Duncan Temple Lang, and Rastislav Bodik. 2017. “Programming with Models: Writing Statistical Algorithms for General Model Structures with NIMBLE.” <em>J. Comput. Graph. Stat.</em> 26 (2): 403–13.</p>
</div>
<div id="ref-Milleret2019Dryad">
<p>Milleret, C, P Dupont, C Bonenfant, H Brøseth, Ø Flagstad, C Sutherland, and R Bischof. 2018. “Data from: A Local Evaluation of the Individual State-Space to Scale up Bayesian Spatial Capture Recapture.” <em>Ecology and Evolution</em>. Dryad Digital Repository. <a href="https://doi.org/doi:10.5061/dryad.42m96c8">https://doi.org/doi:10.5061/dryad.42m96c8</a>.</p>
</div>
<div id="ref-Milleret2019">
<p>Milleret, Cyril, Pierre Dupont, Christophe Bonenfant, Henrik Brøseth, Øystein Flagstad, Chris Sutherland, and Richard Bischof. 2019. “A Local Evaluation of the Individual State-Space to Scale up Bayesian Spatial Capture–Recapture.” <em>Ecology and Evolution</em> 9 (1): 352–63. <a href="https://doi.org/10.1002/ece3.4751">https://doi.org/10.1002/ece3.4751</a>.</p>
</div>
<div id="ref-nimbleSoftware2020">
<p>NIMBLE Development Team. 2020. “NIMBLE: MCMC, Particle Filtering, and Programmable Hierarchical Modeling.” <a href="https://doi.org/10.5281/zenodo.1211190">https://doi.org/10.5281/zenodo.1211190</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
